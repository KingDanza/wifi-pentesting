import subprocess
import time
import os
import colorama
from colorama import Fore, Style
import random

import config
xIface = config.interface

#print(xIface)
########################################################################
cyel = Fore.LIGHTYELLOW_EX
cred = Fore.LIGHTRED_EX
cgreen = Fore.LIGHTGREEN_EX
ccyan = Fore.LIGHTCYAN_EX
cwhite = Fore.LIGHTWHITE_EX
cmagenta = Fore.LIGHTMAGENTA_EX
cyel1 = Fore.YELLOW
cred1 = Fore.RED
cgreen1 = Fore.GREEN
ccyan1 = Fore.CYAN
cwhite1 = Fore.WHITE
cmagenta1 = Fore.MAGENTA
creset = Style.RESET_ALL
font_list = [cmagenta, cwhite, ccyan, cred, cyel, cgreen, cmagenta1, cwhite1, ccyan1, cred1, cyel1, cgreen1]
#xf1 = random.choice(font_list)
xf1 = Fore.WHITE
########################################################################
def banner():
    print('''
██╗    ██╗██████╗  █████╗     ██████╗  ██████╗  ██████╗ ███╗   ███╗     ██╗    ██████╗ 
██║    ██║██╔══██╗██╔══██╗    ██╔══██╗██╔═══██╗██╔═══██╗████╗ ████║    ███║   ██╔═████╗
██║ █╗ ██║██████╔╝███████║    ██║  ██║██║   ██║██║   ██║██╔████╔██║    ╚██║   ██║██╔██║
██║███╗██║██╔═══╝ ██╔══██║    ██║  ██║██║   ██║██║   ██║██║╚██╔╝██║     ██║   ████╔╝██║
╚███╔███╔╝██║     ██║  ██║    ██████╔╝╚██████╔╝╚██████╔╝██║ ╚═╝ ██║     ██║██╗╚██████╔╝
 ╚══╝╚══╝ ╚═╝     ╚═╝  ╚═╝    ╚═════╝  ╚═════╝  ╚═════╝ ╚═╝     ╚═╝     ╚═╝╚═╝ ╚═════╝ 
                                                                                       '''+ xf1)
########################################################################
def clear():
    os.system('clear')  # on Windows System

def mainMenu():
    banner()
    print(89 * "_")
    print('''|[''' + cyel + '''1''' + Style.RESET_ALL + ''']  ''' + cgreen + '''Kill Processes & Enable Moniter Mode''' + Style.RESET_ALL + '''       | Welcome to ''' + cred1 + '''WPA Doom 1.0''' + Style.RESET_ALL + ''' by Danza.    |
''' + xf1 + '''|[''' + cyel + '''2''' + Style.RESET_ALL + ''']  ''' + cred1 + '''Disable Moniter Mode & Enable Networking''' + Style.RESET_ALL + '''   | This is my first real attempt at     |
''' + xf1 + '''|[''' + cyel + '''3''' + Style.RESET_ALL + ''']  Random MAC Address                      ''' + Style.RESET_ALL + '''   | making any pentesting tools, so it's |
''' + xf1 + '''|[''' + cyel + '''4''' + Style.RESET_ALL + ''']  Restore MAC Address                     ''' + Style.RESET_ALL + '''   | no where close to perfect. Make sure |
''' + xf1 + '''|[''' + cyel + '''5''' + Style.RESET_ALL + ''']  Discover Networks''' + Style.RESET_ALL + '''                          | you edit the config file in the same |
''' + xf1 + '''|[''' + cyel + '''6''' + Style.RESET_ALL + ''']  Capture Handshake''' + Style.RESET_ALL + '''                          | folder this script is located. It's  |
''' + xf1 + '''|[''' + cyel + '''7''' + Style.RESET_ALL + ''']  Deauth AP (open new window for this)''' + Style.RESET_ALL + '''       | needed to run the tools.             |
''' + xf1 + '''|[''' + cyel + '''8''' + Style.RESET_ALL + ''']  Cap2hccapx Conversion''' + Style.RESET_ALL + '''                      |                                      |
''' + xf1 + '''|[''' + cyel + '''9''' + Style.RESET_ALL + ''']  Hashcat WPA Crack (mask only)''' + Style.RESET_ALL + '''              | To make sure you have all required   |
''' + xf1 + '''|[''' + cyel + '''10''' + Style.RESET_ALL + '''] Hashcat WPA Crack (wordlist only)''' + Style.RESET_ALL + '''          | tools run option [''' + cyel + '''15''' + Style.RESET_ALL + ''']                |
''' + xf1 + '''|[''' + cyel + '''11''' + Style.RESET_ALL + '''] Restore Hashcat Session''' + Style.RESET_ALL + '''                    |                                      |
''' + xf1 + '''|[''' + cyel + '''12''' + Style.RESET_ALL + '''] Crack With ''' + cgreen + '''Aircrack-ng''' + Style.RESET_ALL + ''' ''' + Style.RESET_ALL + '''                    | This script is and will be buggy & I |
''' + xf1 + '''|[''' + cyel + '''13''' + Style.RESET_ALL + '''] Edit Config File       ''' + Style.RESET_ALL + '''                    | am working my best to fix things.    |
''' + xf1 + '''|[''' + cyel + '''14''' + Style.RESET_ALL + '''] Exit Script (use option [''' + cyel + '''2''' + Style.RESET_ALL + '''] first)      ''' + Style.RESET_ALL + '''   |                                      |
''' + xf1 + '''|[''' + cyel + '''15''' + Style.RESET_ALL + '''] Download Requirements  ''' + Style.RESET_ALL + '''                    |                                      |
''' + xf1 + '''|[''' + cyel + '''16''' + Style.RESET_ALL + '''] Help/Read Me           ''' + Style.RESET_ALL + '''                    | Email: ''' + cyel + '''Z0neyDanza@gmail.com''' + Style.RESET_ALL + '''          |''')
    print(51 * "‾‾")
    tt = input(Style.RESET_ALL + "["+ cyel + "!" + Style.RESET_ALL + "] Make your choice: ")
    if tt == "111111":
        command = "sudo airmon-ng check kill"
        subprocess.call(command, shell=True)
        mainMenu()
    elif tt == "22222":
        command = "sudo service NetworkManager restart"
        subprocess.call(command, shell=True)
        mainMenu()
    elif tt == "31":
        cha = input("Capture path: ")
        wl = input("Wordlist path: ")
        command = "sudo aircrack-ng " + cha + " -w " + wl
        print("sudo aircrack-ng " + cha + " -w " + wl)
        subprocess.call(command, shell=True)
        mainMenu()
        
    
    elif tt == "333333":
        command = "sudo airmon-ng start " + xIface + ""
        #print(command)
        subprocess.call(command, shell=True)
        mainMenu()
    elif tt == "4444444":
        command = "sudo airmon-ng stop " + xIface + "mon"
        #print(command)
        subprocess.call(command, shell=True)
        mainMenu()        
    elif tt == "5":
        command = "sudo airodump-ng " + xIface + "mon"
        #print(command)
        subprocess.call(command, shell=True)
        mainMenu()        
    elif tt == "6":
        fn = input("Name for capture file: ")
        chan = input("Channel of AP: ")
        bssidd = input("BSSID of AP: ")
        command = "sudo airodump-ng -w " + fn + " -c " + chan + " --bssid " + bssidd + " " + xIface + "mon"
        #print(command)
        subprocess.call(command, shell=True)
        mainMenu()       
    elif tt == "7":
        bssidd = input("BSSID of AP: ")
        command = "sudo aireplay-ng --deauth 0 -a " + bssidd + " " + xIface + "mon"
        #print(command)
        subprocess.call(command, shell=True)
        mainMenu()  
    elif tt == "8":
        cappath = input("Handshake path: ")
        hcapname = input("Coverted name (no extension): ")
        command = "sudo /usr/share/hashcat-utils/cap2hccapx.bin " + cappath + " " + hcapname + ".hccapx"
        #print(command)
        subprocess.call(command, shell=True)
        mainMenu()
    elif tt == "9":
        hcappath = input("Hccapx path: ")
        wlist = input("Wordlist path or hashcat charset: (?l?l?l?l?l?d?d?d) ")
        command = "sudo hashcat --potfile-disable -o crack.txt -m 2500 -a 3 " + hcappath + " " + wlist + ""
        print(command)
        subprocess.call(command, shell=True)
        mainMenu()
    elif tt == "11":
        restoreHash()     
    elif tt == "1":
        command = "sudo airmon-ng check kill"
        print(command)
        subprocess.call(command, shell=True)
        command = "sudo airmon-ng start " + xIface + ""
        print(command)
        subprocess.call(command, shell=True)
        mainMenu()
    elif tt == "2":
        command = "sudo airmon-ng stop " + xIface + "mon"
        print(command)
        subprocess.call(command, shell=True)
        command = "sudo service NetworkManager restart"
        print(command)
        subprocess.call(command, shell=True)
        mainMenu()
        
def restoreHash():
        clear()
        command = "sudo hashcat --restore"
        #print(command)
        subprocess.call(command, shell=True)
        print(40 * "-")
        mainMenu()
        
mainMenu()
